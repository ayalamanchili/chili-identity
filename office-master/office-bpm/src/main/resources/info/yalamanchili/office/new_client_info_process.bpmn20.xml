<?xml version="1.0" encoding="UTF-8"?>
<!--

    System Soft Technologies Copyright (C) 2013 ayalamanchili@sstech.mobi

-->
<definitions
    xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
    targetNamespace="http://www.bpmnwithactiviti.org"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:activiti="http://activiti.org/bpmn">
 
    <process id="new_client_info_process">
        <startEvent id="newClientInfoProcessStart"/>
        <sequenceFlow sourceRef="newClientInfoProcessStart" targetRef="newClientInfoContractValidation">
        </sequenceFlow>
        <!--submit User task-->
        <userTask id="newClientInfoContractValidation" 
                  name="New Client Info Contract Validation Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}" >
            <documentation>
                New Client Information has been created with following details. 
                Navigate to MyOffice--> Search--> View --> Client information to verify all data.
                and fill the fields below to complete the task.
                
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{clientAP}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor AP Contact           : #{vendorAP}
                Vendor Payment Terms        : #{clientInfo.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}
                Follow instructions from below:
                https://apps.sstech.us/site/office/bpm/new-client-info-process.html
                    
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="nottes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements>
        </userTask>
        <sequenceFlow sourceRef="newClientInfoContractValidation" targetRef="newClientInfoInvoicingAndBillingTask">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'approved'}
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow sourceRef="newClientInfoContractValidation" targetRef="newClientInfoProcessEnd">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'rejected'}
            </conditionExpression>
        </sequenceFlow>
        <userTask id="newClientInfoInvoicingAndBillingTask" 
                  name="New Client Info Billing/Invoicing Department Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}" 
        >
            <documentation>
                New Client Information has been created with following details. 
                Navigate to MyOffice--> Search--> View --> Client information to verify all data.
                and fill the fields below to complete the task.
                
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{clientAP}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor AP Contact           : #{vendorAP}
                Vendor Payment Terms        : #{clientInfo.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}
                Follow instructions from below:
                https://apps.sstech.us/site/office/bpm/new-client-info-process.html
                    
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="itemNumber" 
                                       name="Item Number"
                                       required="true"
                                       type="string"/>
                <activiti:formProperty id="signedCopyOfWorkOrder" 
                                       name="Signed Copy Of WorkOrder"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="specialInvoiceInstructions" 
                                       name="Special Invoice Instructions"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="timeSheetRequirement" 
                                       name="TimeSheet Requirement"
                                       required="false"
                                       type="enum">
                    <activiti:value id="approved" name="Approved"/>
                    <activiti:value id="need client approval" name="Need Client Approval"/>
                    <activiti:value id="ts exception list" name="TS Exception List"/>
                    <activiti:value id="my apex approved ts" name="My Apex Approved TS"/>
                </activiti:formProperty>
                <activiti:formProperty id="subcontractorw4Filled" 
                                       name="SubContractor W9Filled"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="subcontractCOI" 
                                       name="SubContractor Certificate of Insurance"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="accountNotes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoAccountTaskToSubmit" sourceRef="newClientInfoInvoicingAndBillingTask" targetRef="newClientInfoInvoicingAndBillingSubmit" />
        <!--Submit Service Task-->
        <serviceTask
            id="newClientInfoInvoicingAndBillingSubmit"
            name="New Client Information Account Department Submit" 
            activiti:class="info.yalamanchili.office.client.NewClientInfoInvoicingAndBillingSubmit">
        </serviceTask>
        <sequenceFlow id="newClientInfoAccountSubmitToPayrollTask" 
                      sourceRef="newClientInfoInvoicingAndBillingSubmit" 
                      targetRef="newClientInfoPayrollTask">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'approved' and clientInfo.employee.employeeType.name != 'Subcontractor' and clientInfo.employee.employeeType.name != '1099 Contractor'}
            </conditionExpression>
        </sequenceFlow>
        <userTask id="newClientInfoPayrollTask" 
                  name="New Client Info Payroll Department Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}"
                  activiti:candidateGroups="ROLE_PAYROLL_AND_BENIFITS">
            <documentation>
                New Client Information has been created with following details. 
                Navigate to MyOffice--> Search--> View --> Client information to verify all data.
                and fill the fields below to complete the task.
                
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{clientAP}
                Client Location             : #{clientInfo.clientLocation}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor AP Contact           : #{vendorAP}
                Vendor Payment Terms        : #{clientInfo.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}
                Follow instructions from below:
                https://apps.sstech.us/site/office/bpm/new-client-info-process.html
                    
            </documentation>
        <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="payratePercent" 
                                       name="PayRate Percentage"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="payrate" 
                                       name="PayRate"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="specialNotes" 
                                       name="Special Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoAccountSubmitToHRTask" 
                      sourceRef="newClientInfoPayrollTask" 
                      targetRef="newClientInfoHRTask">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'approved' and clientInfo.employee.employeeType.name != 'Subcontractor' and clientInfo.employee.employeeType.name != '1099 Contractor'}
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="newClientInfoSubmitToContractsAdminTaskForSubC" sourceRef="newClientInfoInvoicingAndBillingSubmit" targetRef="newClientInfoSUBCTask">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'approved' and clientInfo.employee.employeeType.name == 'Subcontractor'}
            </conditionExpression>
        </sequenceFlow>
         <sequenceFlow id="newClientInfoSubmitToContractsAdminTaskFor1099" sourceRef="newClientInfoInvoicingAndBillingSubmit" targetRef="newClientInfoSUBCTask">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'approved' and clientInfo.employee.employeeType.name == '1099 Contractor'}
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="newClientInfoAccountSubmitToEnd" sourceRef="newClientInfoInvoicingAndBillingSubmit" targetRef="newClientInfoProcessEnd">
            <conditionExpression xsi:type="tFormalExpression">
                ${status == 'rejected'}
            </conditionExpression>
        </sequenceFlow>
        <!--submit User task-->
        <userTask id="newClientInfoHRTask" 
                  name="New Client Info HR Department Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}">
            <documentation>
                New Client Information has been created with following details. Please fill the fields below to complete the task.
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{clientAP}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor AP Contact           : #{vendorAP}
                Vendor Payment Terms        : #{clientInfo.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}   
                Follow instructions from below:
                https://apps.sstech.us/site/office/bpm/new-client-info-process.html
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="joiningReport" 
                                       name="Joining Report Details"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="hrOrientation" 
                                       name="HR Orientation"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="accountVerificationDocs" 
                                       name="Account verification Docs"
                                       required="false"
                                       type="boolean"/> 
                <activiti:formProperty id="i9Filled" 
                                       name="I9 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="w4Filled" 
                                       name="W4 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="logisticsPreparation" 
                                       name="Logistics Preparation"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="notes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoHRTaskToSubmit" sourceRef="newClientInfoHRTask" targetRef="newClientInfoHRSubmit" />
        <!--Submit Service Task-->
        <serviceTask
            id="newClientInfoHRSubmit"
            name="New Client Information HR Department Submit"
            activiti:class="info.yalamanchili.office.client.NewClientInfoHRSubmit">
        </serviceTask>
        <sequenceFlow id="newClientInfoHRSubmitToEnd" sourceRef="newClientInfoHRSubmit" targetRef="newClientInfoProcessEnd"/> 
        
        <!-- SUB submit User task-->
        <userTask id="newClientInfoSUBCTask" 
                  name="New Client Info Contracts Admin Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}"
                  activiti:candidateGroups="ROLE_CONTRACTS_ADMIN">
            <documentation>
                New Client Information has been created with following details. Please fill the fields below to complete the task.
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{clientAP}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor AP Contact           : #{vendorAP}
                Vendor Payment Terms        : #{clientInfo.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}  
                Follow instructions from below:
                https://apps.sstech.us/site/office/bpm/new-client-info-process.html  
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="joiningReport" 
                                       name="Joining Report Details"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="hrOrientation" 
                                       name="HR Orientation"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="accountVerificationDocs" 
                                       name="Account verification Docs"
                                       required="false"
                                       type="boolean"/> 
                <activiti:formProperty id="i9Filled" 
                                       name="I9 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="w4Filled" 
                                       name="W4 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="logisticsPreparation" 
                                       name="Logistics Preparation"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="notes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoSubmitToContractsAdmin" sourceRef="newClientInfoSUBCTask" targetRef="newClientInfoSUBCSubmit" />
        <!--Submit Service Task-->
        <serviceTask
            id="newClientInfoSUBCSubmit"
            name="New Client Information Contracts Admin Submit"
            activiti:class="info.yalamanchili.office.client.NewClientInfoHRSubmit">
        </serviceTask>
        <sequenceFlow id="newClientInfoSubmitToEnd" sourceRef="newClientInfoSUBCSubmit" targetRef="newClientInfoProcessEnd"/> 
        <endEvent id="newClientInfoProcessEnd" />
    </process>
</definitions>
