<?xml version="1.0" encoding="UTF-8"?>
<!--

    System Soft Technologies Copyright (C) 2013 ayalamanchili@sstech.mobi

-->
<definitions
    xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
    targetNamespace="http://www.bpmnwithactiviti.org"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:activiti="http://activiti.org/bpmn">
 
    <process id="new_client_info_process">
        <startEvent id="newClientInfoProcessStart"/>
        <sequenceFlow id="newClientInfoProcessStartToAccountTask" sourceRef="newClientInfoProcessStart" targetRef="newClientInfoInvoicingAndBillingTask" />
        <!--submit User task-->
        <userTask id="newClientInfoInvoicingAndBillingTask" 
                  name="New Client Info Billing/Invoicing Department Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}" 
        >
            <documentation>
                New Client Information has been created with following details. Please fill the fields below to complete the task.
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{contractDto.clientAPContact}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor Location             : #{contractDto.vendorLocation}
                Vendor Contact              : #{contractDto.vendorContact}
                Vendor AP Contact           : #{contractDto.vendorAPContact}
                Vendor Payment Terms        : #{contractDto.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}    
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="itemNumber" 
                                       name="Item Number"
                                       required="true"
                                       type="string"/>
                <activiti:formProperty id="signedCopyOfWorkOrder" 
                                       name="Signed Copy Of WorkOrder"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="specialInvoiceInstructions" 
                                       name="Special Invoice Instructions"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="timeSheetRequirement" 
                                       name="TimeSheet Requirement"
                                       required="false"
                                       type="enum">
                    <activiti:value id="approved" name="Approved"/>
                    <activiti:value id="need client approval" name="Need Client Approval"/>
                </activiti:formProperty>
                <activiti:formProperty id="subcontractorw4Filled" 
                                       name="SubContractor W9Filled"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="subcontractCOI" 
                                       name="SubContractor Certificate of Insurance"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="accountNotes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoAccountTaskToSubmit" sourceRef="newClientInfoInvoicingAndBillingTask" targetRef="newClientInfoInvoicingAndBillingSubmit" />
        <!--BulkImport Submit Service Task-->
        <serviceTask
            id="newClientInfoInvoicingAndBillingSubmit"
            name="New Client Information Account Department Submit" 
            activiti:class="info.yalamanchili.office.client.NewClientInfoInvoicingAndBillingSubmit">
        </serviceTask>
        <sequenceFlow id="newClientInfoAccountSubmitToHRTask" sourceRef="newClientInfoInvoicingAndBillingSubmit" targetRef="newClientInfoHRTask" />
        <!--submit User task-->
        <userTask id="newClientInfoHRTask" 
                  name="New Client Info HR Department Task for ${clientInfo.employee.firstName} ${clientInfo.employee.lastName}" 
        >
            <documentation>
               New Client Information has been created with following details. Please fill the fields below to complete the task.
                Employee                    : #{clientInfo.employee.firstName} #{clientInfo.employee.lastName} 
                Employee Type               : #{clientInfo.employee.employeeType.name}
                Consultant Job Title        : #{clientInfo.consultantJobTitle}
                Client                      : #{clientInfo.client.name}
                Client AP Contact           : #{contractDto.clientAPContact}
                Vendor                      : #{clientInfo.vendor.name}
                Vendor Location             : #{contractDto.vendorLocation}
                Vendor Contact              : #{contractDto.vendorContact}
                Vendor AP Contact           : #{contractDto.vendorAPContact}
                Vendor Payment Terms        : #{contractDto.vendorPaymentTerms}
                Project Start Date          : #{clientInfo.startDate}
                Project End Date            : #{clientInfo.endDate}
                Billing Rate                : #{clientInfo.billingRate}
                Overtime Billing Rate       : #{clientInfo.overTimeBillingRate}
                Billing Rate Duration       : #{clientInfo.billingRateDuration}
                Overtime Rate Duration      : #{clientInfo.overTimeRateDuration}
                Invoice Frequency           : #{clientInfo.invoiceFrequency}
                Invoice Delivery Method     : #{clientInfo.invoiceDeliveryMethod}
                Notes                       : #{clientInfo.notes}    
            </documentation>
            <extensionElements>
                <activiti:taskListener event="create" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:taskListener event="complete" class="info.yalamanchili.office.bpm.clientinformation.NewClientInformationProcess" />
                <activiti:formProperty id="status" 
                                       name="Approved?"
                                       required="true"
                                       type="enum">
                    <activiti:value id="approved" name="approved"/>
                    <activiti:value id="rejected" name="rejected"/>
                </activiti:formProperty>
                <activiti:formProperty id="joiningReport" 
                                       name="Joining Report Details"
                                       required="false"
                                       type="string"/>
                <activiti:formProperty id="hrOrientation" 
                                       name="HR Orientation"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="accountVerificationDocs" 
                                       name="Account verification Docs"
                                       required="false"
                                       type="boolean"/> 
                <activiti:formProperty id="i9Filled" 
                                       name="I9 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="w4Filled" 
                                       name="W4 Filled"
                                       required="true"
                                       type="boolean"/>
                <activiti:formProperty id="logisticsPreparation" 
                                       name="Logistics Preparation"
                                       required="false"
                                       type="boolean"/>
                <activiti:formProperty id="notes" 
                                       name="Notes"
                                       required="false"
                                       type="string"/>
            </extensionElements> 
        </userTask>
        <sequenceFlow id="newClientInfoHRTaskToSubmit" sourceRef="newClientInfoHRTask" targetRef="newClientInfoHRSubmit" />
        <!--BulkImport Submit Service Task-->
        <serviceTask
            id="newClientInfoHRSubmit"
            name="New Client Information HR Department Submit"
            activiti:class="info.yalamanchili.office.client.NewClientInfoHRSubmit">
        </serviceTask>
        <sequenceFlow id="newClientInfoHRSubmitToEnd" sourceRef="newClientInfoHRSubmit" targetRef="newClientInfoProcessEnd"/> 
        <endEvent id="newClientInfoProcessEnd" />
    </process>
</definitions>